---
import { posters } from "../../lib/posters.js";
import "../../styles/global.css";
export function getStaticPaths() {
  return posters.map((p, idx) => {
    const prev = posters[idx - 1] ?? null;
    const next = posters[idx + 1] ?? null;

    return {
      params: { no: p.no3 },     // /odop/001
      props: { p, prev, next },  // 페이지에서 사용할 데이터
    };
  });
}

const { p, prev, next } = Astro.props;
---

<main class="detail">
<header class="top">
  <div class="topRow">
    <a class="back" href="/"><span aria-hidden="true">&larr;</span> back</a>

    <nav class="nav">
      {prev ? <a class="btn" data-nav="prev" href={`/odop/${prev.no3}`}>Prev</a> : <span class="btn disabled">Prev</span>}
      {next ? <a class="btn" data-nav="next" href={`/odop/${next.no3}`}>Next</a> : <span class="btn disabled">Next</span>}
    </nav>
  </div>

  <div class="meta">
    <div class="no">{p.title}</div>
    <time class="date" datetime={p.date}>{p.date}</time>
  </div>

  <hr class="rule" />
  <p class="desc">
    {p.desc ?? "You are beutiful. 이거 왜 깨지나요?"}
  </p>
</header>


  <section class="viewer" data-mode="scroll">
  </div>

  <div class="stage">
    <img class="poster" src={p.img} alt={p.title} />
  </div>
</section>

</main>
<script is:inline>
  document.addEventListener("DOMContentLoaded", () => {
    const viewer = document.querySelector(".viewer");
    if (!viewer) return;

    const buttons = document.querySelectorAll("[data-view]");
    buttons.forEach((btn) => {
      btn.addEventListener("click", () => {
        viewer.setAttribute("data-mode", btn.getAttribute("data-view"));
      });
    });
  });
  document.addEventListener("keydown", (e) => {
  if (e.key === "Escape") {
    window.location.href = "/";
  }
  if (e.key === "ArrowLeft") {
    const a = document.querySelector('[data-nav="prev"]');
    if (a) a.click();
  }
  if (e.key === "ArrowRight") {
    const a = document.querySelector('[data-nav="next"]');
    if (a) a.click();
  }
});

</script>

<style>
    @font-face {
  font-family: "Pretendard";
  src: url("/fonts/PretendardVariable.woff2") format("woff2");
  font-weight: 45 920;
  font-style: normal;
  font-display: swap;
}

  :global(body) {
    margin: 0;
    background: #090909;
    color: #f9f9f9;
    
  }

  .detail {
    max-width: 1100px;
    margin: 0 auto;
    padding: 24px;
  }

  .top {
    display: grid;
    gap: 14px;
    margin-bottom: px;
  }

  .back {
    color: rgba(249, 249, 249, 0.7);
    text-decoration: none;
  }

  .no {
    font-weight: 700;
    font-size: 32px;
  }

  .date {
    color: rgba(249, 249, 249, 0.6);
    font-size: 16px;
  }
  .nav {
    display: flex;
    gap: 8px;
  }

  .btn {
    border: 1px solid rgba(249, 249, 249, 0.22);
    padding: 8px 10px;
    border-radius: 5px;
    background: transparent;
    color: #f9f9f9;
    text-decoration: none;
    display: inline-block;
  }

  .disabled {
    opacity: 0.35;
    pointer-events: none;
  }

  .viewer {
    border: 1px solid rgba(249, 249, 249, 0.12);
  }

  .poster {
    width: 100%;
    height: auto;
    display: block;
  }
  .viewer {
  border: 0px solid rgba(249, 249, 249, 0.12);
  padding: 12px;
}

.viewActions {
  display: flex;
  gap: 8px;
  margin-bottom: 12px;
}

.stage {
  border: 1px solid rgba(249, 249, 249, 0.12);
  background: #090909;
}
.top {
  display: grid;
  gap: 14px;
  margin-bottom: 18px;
}

.topRow {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}

.meta {
  display: grid;
  gap: 6px;
}

.rule {
  border: 0;
  border-top: 1px solid rgba(249, 249, 249, 0.16);
  margin: 6px 0 0;
}

.desc {
  margin: 10px 0 0;
  max-width: 70ch;
  line-height: 1.6;
  color: rgba(249, 249, 249, 0.75);
  font-size: 14px;
}

/* nav는 우측에 붙고, 버튼은 기존 btn 스타일 그대로 사용 */
.nav {
  display: flex;
  gap: 8px;
}


/* 기본: Scroll 모드 (가로 100%, 세로는 길면 스크롤) */


</style>
<style is:global>
  @font-face {
    font-family: "Pretendard";
    src: url("/fonts/PretendardVariable.woff2") format("woff2");
    font-weight: 45 920;
    font-style: normal;
    font-display: swap;
  }

</style>
