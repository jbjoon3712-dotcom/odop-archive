---
import { posters } from "../../lib/posters.js";

export function getStaticPaths() {
  return posters.map((p, idx) => {
    const prev = posters[idx - 1] ?? null;
    const next = posters[idx + 1] ?? null;

    return {
      params: { no: p.no3 },     // /odop/001
      props: { p, prev, next },  // 페이지에서 사용할 데이터
    };
  });
}

const { p, prev, next } = Astro.props;
---

<main class="detail">
  <header class="top">
    <a class="back" href="/">← Back</a>

    <div class="meta">
      <div class="no">{p.title}</div>
      <time class="date" datetime={p.date}>{p.date}</time>
    </div>

    <nav class="nav">
      {prev ? <a class="btn" href={`/odop/${prev.no3}`}>Prev</a> : <span class="btn disabled">Prev</span>}
      {next ? <a class="btn" href={`/odop/${next.no3}`}>Next</a> : <span class="btn disabled">Next</span>}
    </nav>
  </header>

  <section class="viewer">
    <img class="poster" src={p.img} alt={p.title} />
  </section>
</main>

<style>
  :global(body) {
    margin: 0;
    background: #090909;
    color: #f9f9f9;
  }

  .detail {
    max-width: 1100px;
    margin: 0 auto;
    padding: 24px;
  }

  .top {
    display: grid;
    gap: 14px;
    margin-bottom: 18px;
  }

  .back {
    color: rgba(249, 249, 249, 0.7);
    text-decoration: none;
  }

  .no {
    font-weight: 700;
    font-size: 18px;
  }

  .date {
    color: rgba(249, 249, 249, 0.6);
    font-size: 12px;
  }

  .nav {
    display: flex;
    gap: 8px;
  }

  .btn {
    border: 1px solid rgba(249, 249, 249, 0.22);
    padding: 8px 10px;
    border-radius: 0;
    background: transparent;
    color: #f9f9f9;
    text-decoration: none;
    display: inline-block;
  }

  .disabled {
    opacity: 0.35;
    pointer-events: none;
  }

  .viewer {
    border: 1px solid rgba(249, 249, 249, 0.12);
  }

  .poster {
    width: 100%;
    height: auto;
    display: block;
  }
</style>
